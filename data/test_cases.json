
[
    { "id": "init_load_script", "category": "App Initialization & File I/O", "description": "Select a standard script (e.g., Tamil). The main application workspace should load correctly without errors.", "priority": "high" },
    { 
      "id": "init_restore_session", 
      "category": "App Initialization & File I/O", 
      "description": "1. Ensure 'Enable Autosave' is on in Settings. 2. Draw a unique shape in a glyph. 3. In Advanced mode, set a kerning value. 4. Refresh the page and select the same script. 5. A 'Restore Session?' modal must appear. 6. Click 'Restore' and verify the drawing and kerning value were restored from IndexedDB. 7. Repeat, but click 'Start Fresh' and verify the project is empty.",
      "priority": "high" 
    },
    {
      "id": "db_save_project",
      "category": "App Initialization & File I/O",
      "description": "Disable Autosave. Make a change. Click 'Save' in the header. A 'Project saved!' notification appears. Refresh and restore to verify changes were saved to IndexedDB.",
      "priority": "high"
    },
    {
      "id": "db_recent_projects_display_load_delete",
      "category": "App Initialization & File I/O",
      "description": "Save a new project and give it a unique name. Go to the script selection screen. Verify the project appears under 'Recent Projects'. Click it to load it. Go back and delete it using the trash icon. Verify it's removed.",
      "priority": "high"
    },
    {
        "id": "init_script_variant_selection",
        "category": "App Initialization & File I/O",
        "description": "Select a script known to have variants (e.g., 'Tamil (Old Style)'). The 'Configure Variants' modal should appear. Select a non-default option for a variant. Start the project and verify that the character set in the Drawing workspace reflects your selection (e.g., shows the old-style 'னா' and not the modern one).",
        "priority": "high"
    },
    { "id": "file_export_project_json", "category": "App Initialization & File I/O", "description": "Click 'Export JSON' in the header menu. A correctly named .json project file should download.", "priority": "high" },
    { "id": "file_load_project", "category": "App Initialization & File I/O", "description": "Click 'Load' and select a valid .json project file. The project state (glyphs, settings, etc.) should be fully restored.", "priority": "high" },
    { "id": "file_load_project_unsaved_changes", "category": "App Initialization & File I/O", "description": "Make a change to a glyph (creating unsaved changes). Click the 'Load' button and select a valid project file. The 'Load New Project?' confirmation modal should appear. Test all three actions: 'Save & Load', 'Load without Saving', and 'Cancel'.", "priority": "high" },
    {
        "id": "init_create_script_from_scratch",
        "category": "App Initialization & File I/O",
        "description": "1. From the Script Selection screen, click 'Create Script'. 2. In the General pane, give the script a unique name. 3. In the Characters pane, add a new Character Set and add at least two characters ('a', 'b'). 4. In the Positioning pane, add one recommended kerning pair ('a', 'b'). 5. Click 'Start Project with this Script'. 6. Verify the app loads your new custom script, showing the correct characters and kerning pair.",
        "priority": "high"
    },
    {
        "id": "init_script_creator_full_lifecycle",
        "category": "App Initialization & File I/O",
        "description": "1. Open the Script Creator. 2. Populate all panes: General (name, metrics), Characters (add sets/chars), Positioning (add kerning/attachment), Rules (add a simple GSUB rule). 3. Click 'Start Project'. Verify the app loads with your new script. 4. Verify all the data you entered is present and functional in the respective workspaces.",
        "priority": "high"
    },
    {
        "id": "init_create_script_from_template",
        "category": "App Initialization & File I/O",
        "description": "1. Click 'Create Script'. 2. Select a template (e.g., Tamil) from the 'Load from Template' dropdown. 3. Verify all panes are populated with the template data. 4. Change the script name. 5. Click 'Start Project with this Script'. 6. Verify the app loads a new custom script with the correct (modified) data.",
        "priority": "medium"
    },
    { "id": "file_import_glyphs_file", "category": "App Initialization & File I/O", "description": "From the header, click 'Import Glyphs'. In the modal, select a valid project file. The 'Select Glyphs' view should appear. Select some glyphs (including some that overwrite existing drawings) and confirm. The glyphs in the main drawing grid should be updated, and a success notification should appear.", "priority": "high" },
    { "id": "file_import_glyphs_recent", "category": "App Initialization & File I/O", "description": "In the 'Import Glyphs' modal, select a project from the 'Recent Projects' list instead of uploading a file. Verify the 'Select Glyphs' view appears and the import process can be completed successfully.", "priority": "medium" },
    { "id": "file_import_glyphs_merge_logic", "category": "App Initialization & File I/O", "description": "In the 'Import Glyphs' modal, load a project. Identify one glyph that is already drawn in the current project ('Overwrite') and one that is empty ('Fill'). Select both. Verify the status text in the list correctly identifies 'Will be overwritten' vs 'Will be filled'.", "priority": "medium" },
    {
      "id": "db_delete_clears_cache",
      "category": "App Initialization & File I/O",
      "description": "Test a font to create a cache entry. Go to script selection and delete the project. (Technical verification: The font cache entry for that project ID should be removed from IndexedDB).",
      "priority": "medium"
    },
    { "id": "file_load_project_with_custom_script", "category": "App Initialization & File I/O", "description": "Save a project that was created using the 'Custom Script' feature. Start a new session. Load that project file. Verify the app correctly identifies it as a custom script and restores its state, character sets, and rules.", "priority": "medium" },
    { "id": "file_load_mismatched_project", "category": "App Initialization & File I/O", "description": "Save a project in one script. Switch to another script via 'New Font'. Try to load the first project. The 'Script Mismatch' warning modal should appear.", "priority": "medium" },
    { "id": "file_load_invalid_json", "category": "App Initialization & File I/O", "description": "Attempt to load a non-project or corrupted JSON file. An 'Error loading project' notification should appear.", "priority": "medium" },
    { "id": "file_load_advanced_in_simple_mode", "category": "App Initialization & File I/O", "description": "Save a project in Advanced mode with kerning and rules. Switch to Simple mode. Load the project. Then switch back to Advanced mode. The kerning and rules data should be preserved and visible again.", "priority": "medium" },
    { "id": "init_custom_script_valid", "category": "App Initialization & File I/O", "description": "On the script selection screen, use 'Custom Script' to upload valid character and rules JSON files. The project should start successfully.", "priority": "medium" },
    { "id": "init_custom_script_invalid", "category": "App Initialization & File I/O", "description": "Attempt to start a 'Custom Script' project with a malformed characters JSON file. An error message should be displayed on the selection screen.", "priority": "medium" },
    { "id": "init_custom_script_with_fea", "category": "App Initialization & File I/O", "description": "On the script selection screen, use 'Custom Script' to upload valid character JSON and a valid FEA file. The project should start in FEA-only mode with the correct code.", "priority": "medium" },
    { "id": "init_load_script_missing_positioning_json", "category": "App Initialization & File I/O", "description": "Create and load a custom script that is missing the `positioning.json` file. The application must load without errors. The Kerning workspace tab must be visible and, when clicked, should open to the 'All Pairs' view by default.", "priority": "medium" },
    { "id": "init_load_script_empty_recommended_kerning", "category": "App Initialization & File I/O", "description": "Create and load a custom script where `positioning.json` exists but contains an empty `recommendedKerning` array (e.g., `\"recommendedKerning\": []`). The application must load, and the Kerning workspace tab must be visible, defaulting to the 'All Pairs' view.", "priority": "medium" },
    { "id": "init_load_script_empty_rules", "category": "App Initialization & File I/O", "description": "Load a script with an empty `rulesPath`. The Rules workspace should load without errors, showing an empty but functional editor.", "priority": "medium" },
    { "id": "init_dynamic_sample_text", "category": "App Initialization & File I/O", "description": "Create a Custom Script but leave the `sampleText` field in `scripts.json` empty. Draw several characters. Open the Font Test page. Verify that the input text area is automatically populated with a sample string containing the characters you have drawn.", "priority": "medium" },
    {
        "id": "init_script_creator_download_jsons",
        "category": "App Initialization & File I/O",
        "description": "In the Script Creator, after entering some data, click the 'Download' button for each of the four JSON file types (scripts, characters, positioning, rules). Verify four valid JSON files are downloaded.",
        "priority": "medium"
    },
    { "id": "init_latin_toggle", "category": "App Initialization & File I/O", "description": "On script selection, toggle 'Include Basic Latin Letters'. Confirm the 'Basic Latin Letters' character set appears in the Drawing workspace.", "priority": "low" },
    {
        "id": "init_new_empty_project_modal",
        "category": "App Initialization & File I/O",
        "description": "Click 'New Empty Project' in the script selection screen. Enter a custom Project Name, Font Family, and UPM (e.g., 2048). Uncheck 'Include Basic Latin'. Start the project. Verify that the Settings -> Metrics tab reflects the custom UPM and the character grid is empty (no Latin chars).",
        "priority": "medium"
    },
    { "id": "nav_script_change_ui_reset", "category": "General UI & Navigation", "description": "Load one script and select a non-default character set tab (e.g., 'Consonants'). Then, go back to the script selection screen and load a different script. The app should open to the *first* character set tab ('Vowels'), not the previously active 'Consonants' tab.", "priority": "high" },
    { "id": "ui_progress_indicator_location", "category": "General UI & Navigation", "description": "Verify that detailed progress bars are visible *inside* the Drawing, Positioning, Kerning, and Rules workspaces. Confirm that the main header tabs do *not* display numerical progress (e.g., '10/180').", "priority": "high" },
    { "id": "ui_kerning_completion_no_pairs", "category": "General UI & Navigation", "description": "Load a script with no recommended kerning pairs. In Advanced mode, verify the 'Kerning' tab in the header has a completion checkmark, and its workspace progress bar shows 100% complete.", "priority": "high" },
    { "id": "nav_workspace_switch", "category": "General UI & Navigation", "description": "Click through each workspace tab (Drawing, Positioning, etc.). The main content area for each should render correctly.", "priority": "high" },
    { "id": "nav_editor_mode_switch", "category": "General UI & Navigation", "description": "Switch between Simple and Advanced modes. Advanced UI elements should appear/disappear. Verify that data entered in Advanced mode (like kerning values or rules) is preserved when switching to Simple and then back to Advanced.", "priority": "high" },
    { "id": "modal_unsaved_drawing", "category": "General UI & Navigation", "description": "Disable Autosave. Make a change in the drawing editor and click Back. The 'Unsaved Changes' modal should appear. Test all three options: Save, Discard, and Cancel.", "priority": "high" },
    { "id": "modal_change_script", "category": "General UI & Navigation", "description": "With unsaved changes, click 'New Font' from the 'More' menu. The 'Unsaved Changes' modal for starting a new project should appear. Test 'Save & Start New' and 'Start New without Saving'.", "priority": "high" },
    { "id": "ui_glyph_modal_shows_drawn_only", "category": "General UI & Navigation", "description": "Draw only a few characters from a character set. Open the glyph selection modal in the rule editor. Verify that only the characters you have drawn are visible for selection.", "priority": "medium" },
    { "id": "ui_glyph_modal_search", "category": "General UI & Navigation", "description": "In the glyph selection modal, type a character name in the search box. Verify the list of glyphs filters to show only matching results.", "priority": "medium" },
    { "id": "ui_glyph_modal_tab_overflow_nav", "category": "General UI & Navigation", "description": "On a narrow screen, open the glyph selection modal. If the character set tabs overflow, verify that left/right navigation arrows appear and are functional.", "priority": "medium" },
    { "id": "nav_font_name_edit", "category": "General UI & Navigation", "description": "Click the edit icon next to the font name, change it, and press Enter. The name should update and be reflected in settings.", "priority": "medium" },
    { "id": "nav_char_set_tabs", "category": "General UI & Navigation", "description": "In Drawing workspace, click on different character set tabs (e.g., Vowels, Consonants). The character grid should update to show the correct glyphs.", "priority": "medium" },
    { "id": "modal_unsaved_rules", "category": "General UI & Navigation", "description": "Disable Autosave. In the Rules workspace, add a rule, then try to switch to another workspace. The 'Unsaved Rules' modal should appear.", "priority": "medium" },
    { "id": "ui_responsiveness", "category": "General UI & Navigation", "description": "Shrink the browser window to a mobile width. Verify the layout adapts, toolbars become horizontal, and content is usable.", "priority": "medium" },
    { "id": "nav_more_menu", "category": "General UI & Navigation", "description": "In the header, click the 'More' button. Verify the menu opens with 'New Font', 'About', 'Help', and 'Test Cases'. Verify clicking each opens the correct modal/view.", "priority": "medium" },
    { "id": "ui_completion_checkmark_header", "category": "General UI & Navigation", "description": "Complete all tasks for a workspace (e.g., draw all glyphs for Drawing). A checkmark should appear on the main workspace tab in the header.", "priority": "medium" },
    { "id": "ui_completion_checkmark_drawing_subtabs", "category": "General UI & Navigation", "description": "In the Drawing workspace, complete all glyphs in a single character set (e.g., 'Vowels'). A checkmark should appear on that specific sub-tab.", "priority": "medium" },
    { "id": "ui_positioning_tab_visibility", "category": "General UI & Navigation", "description": "Load a script with no positioning rules. In Advanced mode, verify the 'Positioning' workspace tab is hidden. Load a script *with* positioning rules and verify it is visible.", "priority": "medium" },
    { "id": "ui_rules_progress_glyph_tracking", "category": "General UI & Navigation", "description": "For a script with OpenType rules, note a required glyph for a rule. Draw that glyph. Verify the progress indicator in the 'Rules' workspace updates to reflect the completion of that required glyph.", "priority": "medium" },
    { "id": "ui_keyboard_navigation_modals", "category": "General UI & Navigation", "description": "Open a modal (e.g., Settings) and verify it can be closed by pressing the 'Escape' key. Verify tabbing focuses elements within the modal only.", "priority": "medium" },
    { "id": "nav_positioning_editor_keyboard", "category": "General UI & Navigation", "description": "In the Positioning editor, use the Left and Right arrow keys on the keyboard. Verify that this navigates to the previous and next combination pairs in the current list.", "priority": "medium" },
    { "id": "global_ctrl_s_autosave_on", "category": "General UI & Navigation", "description": "Turn 'Enable Autosave' ON. Press Ctrl+S (or Cmd+S). Verify that this triggers the 'Export JSON' action (downloading the project file).", "priority": "medium" },
    { "id": "global_ctrl_s_autosave_off", "category": "General UI & Navigation", "description": "Turn 'Enable Autosave' OFF. Press Ctrl+S (or Cmd+S). Verify that this triggers the 'Save' action (saving to local database), showing a 'Project saved!' notification.", "priority": "medium" },
    { "id": "ui_kerning_mobile_scroll_arrows", "category": "General UI & Navigation", "description": "On a mobile screen size, open the Kerning workspace in 'All Pairs' mode. Select enough characters to cause the character chip rows to overflow. Verify that horizontal scroll arrows appear and function correctly for both the left and right character selection rows.", "priority": "low" },
    { "id": "ui_horizontal_scroll_arrows", "category": "General UI & Navigation", "description": "On a narrow screen, in the Drawing workspace, verify that scroll arrows appear for the character set tabs when they overflow, and that they function correctly.", "priority": "low" },
    { "id": "ui_theme_language_change", "category": "General UI & Navigation", "description": "Change the language and theme from the Settings page. All UI text and colors should update immediately and correctly.", "priority": "low" },
    { "id": "ui_donate_notice", "category": "General UI & Navigation", "description": "Wait for the 'Donate' notice to appear. Dismiss it. Refresh the page. The notice should not reappear.", "priority": "low" },
    { "id": "cmd_palette_open_shortcut", "category": "General UI & Navigation", "description": "Press Ctrl+K (or Cmd+K on Mac) anywhere in the app. The Command Palette modal should open, with the input field focused.", "priority": "high" },
    { "id": "cmd_palette_open_button", "category": "General UI & Navigation", "description": "Click the 'Search' button in the header. The Command Palette modal should open.", "priority": "medium" },
    { "id": "cmd_palette_close_behavior", "category": "General UI & Navigation", "description": "Open Command Palette. 1. Press 'Escape' -> Should close. 2. Click backdrop -> Should close.", "priority": "high" },
    { "id": "cmd_palette_nav_arrow_keys", "category": "General UI & Navigation", "description": "Open Command Palette. Type a search term with multiple results. Use Up/Down arrow keys to highlight different items. Press Enter. Verify the highlighted action is executed.", "priority": "high" },
    { "id": "cmd_palette_nav_workspaces", "category": "General UI & Navigation", "description": "Open Command Palette. Type 'Pos'. Verify 'Positioning Workspace' appears in results. Press Enter. The app should switch to the Positioning workspace.", "priority": "high" },
    { "id": "cmd_palette_search_glyph", "category": "General UI & Navigation", "description": "Open Command Palette. Type a character name (e.g., 'ka'). Verify the glyph appears in the list. Select it. The Drawing Modal for that glyph should open.", "priority": "high" },
    { "id": "cmd_palette_search_unicode_char", "category": "General UI & Navigation", "description": "Open Command Palette. Paste or type an actual character (e.g., 'அ'). Verify the corresponding glyph result appears and can be opened.", "priority": "high" },
    { "id": "cmd_palette_search_hex", "category": "General UI & Navigation", "description": "Open Command Palette. Type part of a unicode hex code (e.g., '0B85'). Verify the corresponding glyph ('அ') appears in the results.", "priority": "medium" },
    { "id": "cmd_palette_search_alias", "category": "General UI & Navigation", "description": "Open Command Palette. Type 'Spacing'. Verify 'Kerning' (or 'Spacing') workspace appears, testing the alias functionality.", "priority": "medium" },
    { "id": "cmd_palette_run_action", "category": "General UI & Navigation", "description": "Open Command Palette. Type 'Export'. Verify 'Export OTF' appears. Select it. The font generation/download process should start.", "priority": "medium" },
    { "id": "cmd_palette_run_action_export_json", "category": "General UI & Navigation", "description": "Open Command Palette. Type 'JSON'. Verify 'Export JSON' appears. Select it. The project file should download.", "priority": "medium" },
    { "id": "cmd_palette_search_positioning_pair", "category": "General UI & Navigation", "description": "Open Command Palette. Type a base+mark pair name (e.g., 'ka' and 'i'). If both glyphs are drawn, the 'Positioning' result for that pair should appear. Selecting it should open the Positioning editor for that pair.", "priority": "high" },
    { "id": "cmd_palette_search_kerning_pair", "category": "General UI & Navigation", "description": "Open Command Palette. Type a kerning pair (e.g., 'AV'). If kerning is active and the pair exists, a result should appear. Selecting it should open the Kerning workspace and focus that pair.", "priority": "high" },
    { "id": "cmd_palette_empty_state", "category": "General UI & Navigation", "description": "Open Command Palette. Type a nonsense string (e.g., 'xyz123'). Verify the list shows 'No results found'.", "priority": "low" },
    { "id": "cmd_palette_navigation", "category": "General UI & Navigation", "description": "Use the Command Palette to search for a specific Positioning Pair (e.g., 'ka + i') that exists in the font. Select it. Verify the app switches to the Positioning workspace AND opens the specific editor modal for that pair.", "priority": "high" },
    {
        "id": "session_snapshot_restore",
        "category": "General UI & Navigation",
        "description": "1. Modify the project (e.g., draw a glyph). 2. Go to 'More' menu -> 'Take Snapshot'. 3. Make further changes or delete the glyph. 4. Go to 'More' menu -> 'Restore Snapshot'. 5. Verify a confirmation modal appears showing the timestamp. 6. Confirm and verify the project reverts exactly to the snapshot state.",
        "priority": "high"
    },
    { "id": "session_snapshot_delete", "category": "General UI & Navigation", "description": "Take a snapshot. Open the 'Restore Snapshot' modal. Hover over the snapshot item and click the Trash icon. Verify the snapshot is removed from the list.", "priority": "low" },
    {
      "id": "session_snapshot_limit",
      "category": "General UI & Navigation",
      "description": "Take more than 5 snapshots. Verify that the list only retains the 5 most recent snapshots and automatically deletes older ones.",
      "priority": "medium"
    },
    { "id": "search_smart_hex", "category": "General UI & Navigation", "description": "In Command Palette or Filter, type '0x0041' or 'U+0041'. Verify 'A' appears as the result.", "priority": "medium" },
    { "id": "search_create_glyph_flow", "category": "General UI & Navigation", "description": "In Command Palette, type a name that doesn't exist (e.g., 'MyLogo'). Verify a 'Create glyph for...' option appears. Click it. Verify a new glyph is created and opened.", "priority": "high" },
    { "id": "search_exact_match_quotes", "category": "General UI & Navigation", "description": "In Command Palette, search for `\"a\"` (with quotes). Verify that the result list prioritizes the exact character 'a' over characters containing 'a' (like 'Alpha').", "priority": "low" },
    { "id": "ui_grid_ghost_buttons_hidden", "category": "General UI & Navigation", "description": "In the Drawing Workspace, enter text into the Filter input (e.g., 'a'). Verify that the 'Add Glyph' and 'Add Block' ghost buttons at the end of the grid disappear while filtering.", "priority": "low" },

    {
      "id": "draw_linked_glyph_creation_and_lock",
      "category": "Drawing Workspace: Glyph Management",
      "description": "1. Draw component glyphs 'க' and '்'. 2. Open the editor for 'க்', which is defined with `\"link\": [\"க\", \"்\"]`. 3. Verify it is pre-filled. 4. Verify the toolbar shows a 'Locked' icon and that drawing/editing tools are disabled. 5. Using the 'Select' tool, verify that the transform mode is 'move-only' (no scale/rotate handles).",
      "priority": "high"
    },
    {
      "id": "draw_linked_glyph_unlock",
      "category": "Drawing Workspace: Glyph Management",
      "description": "1. Following the 'linked glyph creation' test, click the 'Unlock' button in the toolbar. 2. A confirmation modal (`unlockGlyphTitle`) must appear. 3. Confirm the unlock. 4. Verify the 'Locked' icon disappears and all drawing/editing tools become enabled. 5. The glyph's internal definition should now use `composite` instead of `link`.",
      "priority": "high"
    },
    {
      "id": "draw_refresh_linked_glyph",
      "category": "Drawing Workspace: Glyph Management",
      "description": "1. Open a linked glyph (e.g., 'க்'). 2. Go to the component glyph ('க') and modify it (e.g., add a stroke). Save. 3. Return to 'க்'. 4. Click the 'Refresh' button (Redo icon) in the header. 5. Verify the glyph updates to reflect the changes made to the component.",
      "priority": "medium"
    },
    {
      "id": "draw_cascading_update_shape",
      "category": "Drawing Workspace: Glyph Management",
      "description": "1. Ensure 'க்' is a linked glyph (from 'க' + '்'). 2. Open 'க', use the 'Edit Points' tool to alter its shape (e.g., add a spike), and save. 3. The 'Update Dependent Glyphs?' modal must appear. 4. Click 'Update All'. 5. Open 'க்' again and verify its shape has been updated to reflect the new 'க' shape.",
      "priority": "high"
    },
    {
      "id": "draw_cascading_update_transform",
      "category": "Drawing Workspace: Glyph Management",
      "description": "1. Ensure 'க்' is a linked glyph. 2. Open 'க', select all its paths, and scale them down by 50%. Save. 3. Confirm the 'Update Dependent Glyphs' modal. 4. Open 'க்' and verify that the 'க' component within it is now 50% smaller, maintaining its relative position to the '்' component.",
      "priority": "high"
    },
    {
        "id": "draw_cascade_deep_nesting",
        "category": "Drawing Workspace: Glyph Management",
        "description": "1. Create a glyph A. 2. Create glyph B using A as a linked component. 3. Create glyph C using B as a linked component. 4. Modify A and save. 5. Verify that both B and C update their appearance correctly to reflect the change in A.",
        "priority": "high"
    },
    {
      "id": "draw_composite_transform_touching",
      "category": "Drawing Workspace: Glyph Management",
      "description": "1. Find or create a character with `\"compositeTransform\": [[1], [1, \"touching\"]]` (e.g., Malayalam 'ള്ള' from 'ള'+'ള'). 2. Draw the component glyph 'ള'. 3. Open the editor for 'ള്ള'. 4. Verify it's pre-filled with two 'ള' shapes, with the right edge of the first touching the left edge of the second.",
      "priority": "medium"
    },
    {
      "id": "draw_composite_transform_absolute",
      "category": "Drawing Workspace: Glyph Management",
      "description": "1. Find or create a character with `\"compositeTransform\": [[1], [0.6, 200, \"absolute\"]]` (e.g., Malayalam 'സ്സ' from 'സ'+'സ'). 2. Draw the component glyph 'സ'. 3. Open the editor for 'സ്സ'. 4. Verify the second 'സ' component is scaled down and positioned at an absolute Y-coordinate, not relative to the first component.",
      "priority": "medium"
    },
    {
        "id": "draw_circular_dependency_prevention",
        "category": "Drawing Workspace: Glyph Management",
        "description": "ADVANCED: Attempt to create a custom glyph 'A' that links to 'B', where 'B' already links to 'A'. The system should either prevent this assignment or handle the render gracefully without crashing the browser (e.g. rendering limit depth).",
        "priority": "low"
    },
    { "id": "glyph_composite_prefill", "category": "Drawing Workspace: Glyph Management", "description": "Draw the components of a composite character (e.g., 'க' and '்'). Open the editor for the composite ('க்'). It should be pre-filled with the component paths.", "priority": "high" },
    {
      "id": "draw_composite_prefill_with_mark_attachment",
      "category": "Drawing Workspace: Glyph Management",
      "description": "For a script with `markAttachment` rules (e.g., Tamil), draw a base (`க`) and a mark (`ி`). Open the editor for their composite (`கி`), which has no drawing. The canvas must be pre-filled with both components, and the mark (`ி`) must be positioned correctly based on the defined `markAttachment` rule, not at the origin.",
      "priority": "high"
    },
    {
      "id": "draw_autosave_debounce",
      "category": "Drawing Workspace: Glyph Management",
      "description": "Enable Autosave. Open a glyph. Draw a stroke. Wait 500ms. Verify 'Save' is triggered. Draw two strokes quickly (within 200ms). Verify 'Save' is triggered only once after the second stroke.",
      "priority": "high"
    },
    { "id": "glyph_add_custom_to_active_set", "category": "Drawing Workspace: Glyph Management", "description": "ADVANCED: Navigate to a non-default character set tab (e.g., 'Consonants'). Use the 'Add Glyph' feature to add a new custom character. Verify that the new character appears in the 'Consonants' grid and that no new 'Custom Glyphs' or 'Dynamic Ligatures' tab is created.", "priority": "high" },
    { "id": "glyph_add_unicode_block", "category": "Drawing Workspace: Glyph Management", "description": "ADVANCED: In the main grid, click 'Add Block'. Select a block like 'Basic Latin' from the modal. The app should add all characters from that block that are not already present in the font and show a success notification.", "priority": "medium" },
    { "id": "unicode_block_search", "category": "Drawing Workspace: Glyph Management", "description": "In the 'Add Block' modal, use the search bar to filter blocks (e.g., type 'Cyrillic'). Verify the dropdown updates to show only matching blocks.", "priority": "low" },
    {
        "id": "glyph_add_block_with_marks_warning",
        "category": "Drawing Workspace: Glyph Management",
        "description": "In the 'Add Block' modal, select 'Combining Diacritical Marks'. Click 'Add'. A warning modal ('Warning: Add Block with Marks') should appear advising about positioning rules. Verify you can 'Cancel' or 'Proceed'.",
        "priority": "low"
    },
    { "id": "draw_single_composite_prefill_tool", "category": "Drawing Workspace: Glyph Management", "description": "For a script with single-component composites (e.g., 'É' from 'E' in French), draw the base component ('E'). Open the editor for the composite ('É'). Verify it is pre-filled and that the default tool is the **Pen tool**, not the Select tool.", "priority": "medium" },
    { "id": "glyph_composite_prefill_incomplete", "category": "Drawing Workspace: Glyph Management", "description": "For a composite glyph (e.g., 'க்' = 'க' + '்'), draw only one component (e.g., 'க'). Open the editor for 'க்'. It should open empty without error, not partially pre-filled.", "priority": "medium" },
    { "id": "glyph_modal_navigation", "category": "Drawing Workspace: Glyph Management", "description": "Inside the drawing modal, use the left/right arrow buttons to navigate to the previous/next glyph in the character set.", "priority": "medium" },
    { "id": "glyph_add_custom", "category": "Drawing Workspace: Glyph Management", "description": "ADVANCED: In the main grid, click the '+' button to open the 'Add New Glyph' modal. Add a glyph by character and by codepoint.", "priority": "medium" },
    { "id": "glyph_delete_custom", "category": "Drawing Workspace: Glyph Management", "description": "ADVANCED: Open a custom-added glyph in the editor and click 'Delete Glyph'. Confirm deletion and verify it is removed from the character set.", "priority": "medium" },
    { "id": "glyph_delete_standard", "category": "Drawing Workspace: Glyph Management", "description": "ADVANCED: Try to delete a standard glyph from the script. A warning modal should appear before confirming deletion.", "priority": "medium" },
    { "id": "glyph_properties_panel", "category": "Drawing Workspace: Glyph Management", "description": "ADVANCED: Open the glyph properties panel in the Drawing Modal, change the LSB/RSB values, and save. The changes should persist.", "priority": "medium" },
    { "id": "glyph_properties_non_spacing_toggle", "category": "Drawing Workspace: Glyph Management", "description": "Open Glyph Properties for a character. Set Glyph Class to 'Mark'. Toggle 'Non-spacing (Width: 0)' ON. Verify the 'Adv. Width' field becomes disabled/hidden or set to 0, and the glyph renders with 0 width in exports.", "priority": "medium" },
    { "id": "glyph_properties_construction_type_switch", "category": "Drawing Workspace: Glyph Management", "description": "Open Glyph Properties. Switch Construction tab from 'Draw' to 'Composite'. Add a component. Switch to 'Link'. Verify the internal definition changes from `composite` to `link` and the UI updates (e.g., locking behavior).", "priority": "high" },
    { "id": "glyph_properties_transform_modes", "category": "Drawing Workspace: Glyph Management", "description": "In Glyph Properties (Advanced), expand 'Advanced Transforms' for a component. Switch positioning mode from 'Rel' (Relative) to 'Abs' (Absolute) and 'Tch' (Touching). Verify the visual positioning of the component changes on the canvas according to the selected mode.", "priority": "high" },
    { "id": "glyph_add_existing_error", "category": "Drawing Workspace: Glyph Management", "description": "ADVANCED: In the 'Add New Glyph' modal, attempt to add a character that already exists (e.g., 'அ' in the Tamil script). An error message should be displayed.", "priority": "medium" },
    { "id": "file_load_project_with_custom_glyphs", "category": "Drawing Workspace: Glyph Management", "description": "Load a project file that contains custom glyphs added via the 'Add Glyph' modal. Verify they load correctly into a 'Dynamic Ligatures' or similar set.", "priority": "medium" },
    { "id": "glyph_add_supplementary", "category": "Drawing Workspace: Glyph Management", "description": "ADVANCED: In the 'Add New Glyph' modal, add a supplementary plane character (e.g., U+1F600). The glyph should be added to a 'Dynamic' character set and be editable.", "priority": "low" },
    { "id": "group_tab_create", "category": "Drawing Workspace: Glyph Management", "description": "In Drawing Workspace, click the '+' icon next to the character set tabs. Enter a name. Verify a new empty tab is created and activated.", "priority": "medium" },
    { "id": "group_tab_rename", "category": "Drawing Workspace: Glyph Management", "description": "Right-click (or long-press on touch) a character set tab. Select 'Rename Group'. Enter new name. Verify tab name updates.", "priority": "medium" },
    { "id": "group_tab_delete", "category": "Drawing Workspace: Glyph Management", "description": "Right-click a custom group tab. Select 'Delete Group'. Confirm warning. Verify tab is removed.", "priority": "medium" },
    {
      "id": "draw_construction_mode_warning",
      "category": "Drawing Workspace: Glyph Management",
      "description": "Draw a shape in a base glyph. Open Glyph Properties. Switch the Construction tab from 'Draw' to 'Composite' or 'Link'. Verify that a warning modal appears stating that existing drawings will be discarded.",
      "priority": "medium"
    },

    { "id": "draw_all_tools", "category": "Drawing Workspace: Editor & Tools", "description": "Sequentially use each drawing tool (Pen, Line, Circle, Ellipse, Curve, Dot) to create shapes on the canvas.", "priority": "high" },
    { "id": "draw_path_winding_holes", "category": "Drawing Workspace: Editor & Tools", "description": "Draw a shape like an 'O' or 'e'. Ensure the outer path is drawn clockwise and the inner path (hole) is drawn counter-clockwise. Export the font and test it to verify the hole is rendered transparently (not filled black).", "priority": "high" },
    { "id": "draw_svg_import_and_edit", "category": "Drawing Workspace: Editor & Tools", "description": "In the drawing editor, use 'Import SVG' to load a simple vector file. The SVG should appear on the canvas. Switch to Advanced mode and use the 'Edit Points' tool to verify that the imported shape is a native, editable outline path with anchor and control points.", "priority": "high" },
    {
        "id": "draw_svg_import_robustness",
        "category": "Drawing Workspace: Editor & Tools",
        "description": "Import an SVG file that contains multiple, separate, non-overlapping shapes. Verify that the importer creates a single `CompoundPath` (a single selectable item) from these shapes. Then import another SVG with overlapping shapes. Verify the shapes are correctly united into a single outline.",
        "priority": "medium"
    },
    { "id": "draw_select_tool_marquee_select", "category": "Drawing Workspace: Editor & Tools", "description": "1. Draw at least two distinct paths on the canvas. 2. Using the Select tool, click on an empty part of the canvas and drag a box that fully encloses the paths. 3. Release the mouse. 4. Verify that all paths within the marquee box are selected and a bounding box surrounds them.", "priority": "high" },
    { "id": "draw_select_tool_group_move", "category": "Drawing Workspace: Editor & Tools", "description": "1. Draw two separate paths. 2. Use the marquee select to select both. A single bounding box should appear. 3. Click and drag from an empty space *inside* this bounding box. 4. Verify that *both* paths move together as a single group.", "priority": "high" },
    { "id": "draw_select_tool_shift_click", "category": "Drawing Workspace: Editor & Tools", "description": "Select one path. Hold the Shift key and click another path. Both paths should now be selected. Hold Shift and click one of the selected paths again. It should be deselected while the other remains selected.", "priority": "high" },
    {
        "id": "draw_group_ungroup",
        "category": "Drawing Workspace: Editor & Tools",
        "description": "1. Draw multiple paths. 2. Select them and click the 'Group' button. 3. Click one path; the whole group should select. 4. Move/scale the group. All paths should transform together. 5. With the group selected, click 'Ungroup'. 6. Verify paths can now be selected and transformed individually.",
        "priority": "high"
    },
    { "id": "draw_select_tool_mobile_handles_appearance", "category": "Drawing Workspace: Editor & Tools", "description": "On a small screen (mobile), open a glyph with paths in the editor and use the Select tool. Verify that the selection handles are noticeably larger than on desktop. The top-left handle should be a solid circle, while others remain squares.", "priority": "high" },
    { "id": "draw_select_tool_mobile_move", "category": "Drawing Workspace: Editor & Tools", "description": "On a small screen, select a path. Drag the top-left circular handle. The entire selection should move without changing its size or proportions.", "priority": "high" },
    { "id": "draw_select_tool_mobile_proportional_scale", "category": "Drawing Workspace: Editor & Tools", "description": "On a small screen, select a path. Drag a corner handle (other than the top-left one, e.g., bottom-right). The selection should scale proportionally, maintaining its aspect ratio.", "priority": "high" },
    { "id": "draw_select_tool_mobile_nonproportional_scale", "category": "Drawing Workspace: Editor & Tools", "description": "On a small screen, select a path. Drag a side handle (e.g., the middle-right handle). The selection should stretch horizontally or vertically only, without maintaining its aspect ratio.", "priority": "medium" },
    { "id": "draw_select_tool_mobile_rotate", "category": "Drawing Workspace: Editor & Tools", "description": "On a small screen, select a path. Drag a rotation handle located above the selection box. The selection should rotate around its center.", "priority": "high" },
    { "id": "draw_edit_points_tool", "category": "Drawing Workspace: Editor & Tools", "description": "ADVANCED: Use Edit Points tool. Select a path, drag its anchor (red) and control (yellow) points. Double-click a segment to add a point. Double-click a point to delete it.", "priority": "high" },
    { "id": "draw_undo_redo", "category": "Drawing Workspace: Editor & Tools", "description": "Perform an action (e.g., draw a stroke), click Undo, then click Redo. The action should be reversed and then restored.", "priority": "high" },
    { "id": "draw_image_trace", "category": "Drawing Workspace: Editor & Tools", "description": "In the drawing editor, use 'Trace Image'. Upload a simple black and white image. In the trace modal, adjust detail/noise sliders and see the live preview update. Toggle 'Remove white background'. Click 'Insert as Vector Path'. Verify the traced outline is added to the canvas and is selectable/editable.", "priority": "high" },
    { "id": "draw_manual_counters", "category": "Drawing Workspace: Editor & Tools", "description": "Draw a shape (e.g., a circle). Draw a smaller shape completely inside it (e.g., another circle). Export the font and test it to verify the hole is rendered transparently (not filled black).", "priority": "medium" },
    {
        "id": "draw_keyboard_shortcuts_modal",
        "category": "Drawing Workspace: Editor & Tools",
        "description": "Open the drawing modal. Verify keyboard shortcuts work: Ctrl/Cmd+Z for undo, Ctrl/Cmd+Shift+Z for redo, Ctrl/Cmd+C for copy, Ctrl/Cmd+X for cut, Ctrl/Cmd+V for paste. Select a path and use arrow keys (and Shift+arrow keys) to move it. Press Delete to remove the selection.",
        "priority": "medium"
    },
    {
        "id": "draw_group_linked_glyph",
        "category": "Drawing Workspace: Editor & Tools",
        "description": "1. Open a linked glyph (e.g., 'க்'). The components are implicitly grouped. 2. Unlock the glyph. The components should now be individual paths/groups. 3. Select all paths and group them. Verify they now act as a single user-defined group. 4. Ungroup them and verify they are individual again.",
        "priority": "medium"
    },
    { "id": "draw_eraser_tool", "category": "Drawing Workspace: Editor & Tools", "description": "Draw a stroke, then use the Eraser tool to remove part of it. The stroke should split into two separate paths.", "priority": "medium" },
    { "id": "draw_eraser_on_overlapping_paths", "category": "Drawing Workspace: Editor & Tools", "description": "Draw two separate paths that overlap significantly. Use the eraser across the intersection. Verify both paths are correctly split.", "priority": "medium" },
    { "id": "draw_pan_zoom", "category": "Drawing Workspace: Editor & Tools", "description": "Use the Pan tool and Zoom buttons/scroll wheel. The canvas should pan and zoom smoothly.", "priority": "medium" },
    { "id": "draw_image_guide", "category": "Drawing Workspace: Editor & Tools", "description": "Import an image, verify it appears. Adjust opacity, move/resize/rotate it using Select tool, then clear it.", "priority": "medium" },
    { "id": "draw_clipboard", "category": "Drawing Workspace: Editor & Tools", "description": "Select a stroke, use Copy, then Paste. A duplicate should appear. Use Cut, then Paste. The original should move.", "priority": "medium" },
    { "id": "draw_clipboard_between_glyphs", "category": "Drawing Workspace: Editor & Tools", "description": "In the editor for glyph 'A', select and copy a path. Open the editor for glyph 'B' and paste. The path from 'A' should appear in 'B's editor.", "priority": "medium" },
    { "id": "draw_clear_canvas", "category": "Drawing Workspace: Editor & Tools", "description": "Draw several strokes, then click the 'Clear' button. The canvas should be emptied. Verify this action is undoable.", "priority": "medium" },
    { "id": "draw_transform_self_intersecting", "category": "Drawing Workspace: Editor & Tools", "description": "Create a path that intersects with itself (e.g., a figure-eight). Select and transform it (move, scale, rotate). Verify it behaves predictably without visual artifacts.", "priority": "medium" },
    { "id": "draw_paste_large_clipboard", "category": "Drawing Workspace: Editor & Tools", "description": "Copy a glyph with a very large number of paths (>50). Paste it into another glyph's editor. Verify the operation completes without freezing the UI and that all paths are pasted.", "priority": "medium" },
    { "id": "draw_edit_points_add_point", "category": "Drawing Workspace: Editor & Tools", "description": "ADVANCED: In the Edit Points tool, draw an SVG outline path (or import one). Double-click on a segment of the path *between* two anchor points. A new anchor point should be created at that location.", "priority": "medium" },
    { "id": "draw_image_trace_options", "category": "Drawing Workspace: Editor & Tools", "description": "In the Image Trace modal, change the values for 'Detail Level', 'Noise Reduction', and 'Corner Smoothing'. Verify that the SVG preview updates to reflect these changes. Toggle 'Remove white background' and confirm the preview changes.", "priority": "medium" },
    { "id": "draw_edit_points_edge_cases", "category": "Drawing Workspace: Editor & Tools", "description": "ADVANCED: In Edit Points mode, delete the very first or last point of a multi-point path. The path should remain valid.", "priority": "low" },
    { "id": "draw_calligraphy_tool_options", "category": "Drawing Workspace: Editor & Tools", "description": "ADVANCED: Use the Calligraphy Pen. Click the tool icon again to open the angle picker and select a new angle. Verify stroke thickness changes with direction.", "priority": "low" },
    { "id": "draw_svg_import_invalid", "category": "Drawing Workspace: Editor & Tools", "description": "In the drawing editor, attempt to import an empty or malformed SVG file. Verify that an appropriate error notification appears and the canvas remains unchanged.", "priority": "medium" },
    { "id": "draw_zero_point_handling", "category": "Drawing Workspace: Editor & Tools", "description": "Use the Pen tool to create paths with 0 or 1 points (clicks without drag). Save and reload the glyph. Verify these degenerate paths are cleaned up or handled without error.", "priority": "medium" },
    { "id": "draw_eraser_complex", "category": "Drawing Workspace: Editor & Tools", "description": "Draw a filled `outline` shape (e.g., from an SVG import). Attempt to use the eraser on it. Verify the eraser is ignored and an informational notification appears. Draw a self-intersecting path and verify the eraser correctly splits it into multiple valid segments.", "priority": "low" },
    { "id": "tool_slice_basic", "category": "Drawing Workspace: Editor & Tools", "description": "Draw a circle. Select Slice tool. Click outside the circle, drag across it to the other side. Verify the circle is split into two separate semi-circle paths.", "priority": "high" },
    { "id": "tool_slice_closed_shape", "category": "Drawing Workspace: Editor & Tools", "description": "Draw a closed circle. Use the Slice tool to cut it straight down the middle. Verify it splits into two separate open arcs (semi-circles) that can be moved independently.", "priority": "medium" },
    { "id": "draw_contextual_toolbar_flip", "category": "Drawing Workspace: Editor & Tools", "description": "Select a path. In the floating Contextual Toolbar, click the 'Flip Horizontal' and 'Flip Vertical' icon buttons. Verify the path geometry mirrors accordingly in real-time.", "priority": "medium" },
    { "id": "draw_contextual_toolbar_numeric_input", "category": "Drawing Workspace: Editor & Tools", "description": "Select a path. In the Contextual Toolbar, type '45' into the Rotation input and press Enter. Verify the selection rotates 45 degrees. Type '2.0' into Scale and press Enter. Verify it doubles in size.", "priority": "medium" },

    { "id": "batch_select_toggle", "category": "Drawing Workspace: Batch Operations", "description": "In Drawing Workspace, click the 'Select' (Batch) icon in the sub-header. Verify the UI changes: bottom/top action bar appears, glyph cards become selectable.", "priority": "high" },
    { "id": "batch_select_interaction", "category": "Drawing Workspace: Batch Operations", "description": "In Batch Mode, click multiple glyph cards. Verify the selection counter increments. Click 'Select All'. Click 'Select None'.", "priority": "medium" },
    { "id": "batch_transform_rotate", "category": "Drawing Workspace: Batch Operations", "description": "Select multiple glyphs. Click 'Transform'. Enter 90 degrees rotation. Click Apply. Verify all selected glyphs are rotated.", "priority": "high" },
    { "id": "batch_transform_flip", "category": "Drawing Workspace: Batch Operations", "description": "Select multiple glyphs. Click 'Transform'. Check 'Flip Horizontal'. Click Apply. Verify selected glyphs are mirrored.", "priority": "medium" },
    { "id": "batch_bulk_delete_confirm", "category": "Drawing Workspace: Batch Operations", "description": "Select multiple glyphs. Click 'Delete'. Verify a confirmation modal appears with the count. Confirm. Verify glyphs are removed/cleared.", "priority": "high" },
    { "id": "batch_bulk_properties", "category": "Drawing Workspace: Batch Operations", "description": "Select multiple glyphs. Click 'Edit Properties'. Change LSB to 50. Save. Verify all selected glyphs now have LSB 50.", "priority": "medium" },
    {
      "id": "batch_transform_undo",
      "category": "Drawing Workspace: Batch Operations",
      "description": "Perform a batch transform (e.g., Rotate 90 degrees). A toast notification with an 'Undo' button should appear. Click Undo. Verify all selected glyphs revert to their original orientation.",
      "priority": "medium"
    },

    { "id": "creator_open_render", "category": "Creator Studio", "description": "Click the 'Create' (purple) button in the header. Verify the Studio overlay opens. Type text in the sidebar input. Verify the text renders on the canvas using the current font.", "priority": "high" },
    { "id": "creator_styling", "category": "Creator Studio", "description": "In Studio, change Text Color and Background Color. Toggle Shadow on/off. Change Text Alignment. Verify visual updates on canvas immediately.", "priority": "medium" },
    { "id": "creator_drag_text", "category": "Creator Studio", "description": "In Studio, click and drag the rendered text on the canvas. It should move freely. Release mouse to place it.", "priority": "high" },
    { "id": "creator_bg_image", "category": "Creator Studio", "description": "In Studio, upload a background image. Verify it appears behind the text. Adjust the 'Dimmer' opacity slider. Verify the overlay darkness changes.", "priority": "medium" },
    { "id": "creator_export", "category": "Creator Studio", "description": "In Studio, click the Download icon. Verify a PNG image is generated and downloaded containing the composed text and background.", "priority": "high" },

    { "id": "pos_edit_position", "category": "Positioning Workspace", "description": "Select a base character, click a combination card, and move the mark in the editor. Save/go back. The card should reflect the new position.", "priority": "high" },
    { "id": "pos_nav_unsaved_modal", "category": "Positioning Workspace", "description": "Disable Autosave. In the Positioning editor, make a change to a pair's position. Click the 'Next', 'Previous', or 'Back' buttons. The 'Unsaved Changes' modal should appear. Test all three options: Save, Discard, and Cancel.", "priority": "high" },
    {
      "id": "pos_reset_single_pair",
      "category": "Positioning Workspace",
      "description": "1. Manually position a mark on a base and save it. 2. Re-open that pair in the Positioning editor. 3. Click the 'Reset Position' button. 4. A confirmation modal should appear. Confirm the reset. 5. Verify that the mark returns to its default calculated position and the pair is now marked as 'Un-positioned' in the main grid.",
      "priority": "high"
    },
    {
        "id": "pos_reset_undo",
        "category": "Positioning Workspace",
        "description": "Reset a manually positioned pair. An 'Undo' notification should appear. Click Undo. Verify the custom position is restored.",
        "priority": "medium"
    },
    {
      "id": "pos_reset_all_for_item",
      "category": "Positioning Workspace",
      "description": "1. Manually position several marks on a single base character. 2. In the Positioning workspace, with that base character selected, click the 'Reset Positions' button. 3. A confirmation modal should appear. Confirm the reset. 4. Verify that *all* combination cards for that base character revert to their 'Un-positioned' state and show default positions.",
      "priority": "high"
    },
    {
        "id": "pos_reset_gsub_ligature_deletion",
        "category": "Positioning Workspace",
        "description": "1. Create a positioning rule that generates a GSUB ligature (e.g., base+mark -> ligature glyph). 2. Position the pair to create the ligature glyph. 3. Verify the ligature exists in the drawing view. 4. In Positioning, click 'Reset Position' for that pair. 5. Verify the ligature glyph is deleted/cleared from the project.",
        "priority": "medium"
    },
    { "id": "pos_progress_count", "category": "Positioning Workspace", "description": "Load a script with defined positioning rules. The progress indicator in the Positioning workspace should show the correct total number of unique pairs to be positioned.", "priority": "high" },
    { "id": "pos_unpositioned_card_previews_attachment_rule", "category": "Positioning Workspace", "description": "For a script with `markAttachment` rules (e.g., Tamil), draw a base (`க`) and a mark (`ி`). In the Positioning workspace, view the combinations for `க`. The card for `கி` should be 'Un-positioned', but its preview canvas must show the mark positioned correctly according to the default `markAttachment` rule.", "priority": "high" },
    {
      "id": "pos_composite_linked_pairs",
      "category": "Positioning Workspace",
      "description": "1. Use a script where composite/linked characters are included in positioning rules (e.g., Malayalam, where conjuncts like 'ക്ക' are valid bases). 2. Draw the components (e.g., 'ക') and a mark that can be positioned on it (e.g., 'ു'). 3. Go to the Positioning workspace and select the composite character ('ക്ക') from the 'View by Base' list. 4. Verify that the combination card for 'ക്കു' appears. 5. Open the editor and confirm that the pre-filled 'ക്ക' glyph is displayed correctly as the base, ready for the 'ു' mark to be positioned.",
      "priority": "high"
    },
    { "id": "pos_mark_attachment_class_cascade", "category": "Positioning Workspace", "description": "1. For a script with a `markAttachmentClass` (e.g., Tamil (Simple Design), with `['ி', 'ீ']` in a class), draw the base `க` and marks `ி`, `ீ`. 2. Position `ி` on `க` and save. 3. Verify that the card for `கീ` (`க`+`ீ`) automatically becomes 'Positioned' and that the mark `ீ` has the same relative position as `ி`.", "priority": "high" },
    { "id": "pos_base_attachment_class_cascade", "category": "Positioning Workspace", "description": "1. For a script with a `baseAttachmentClass` (e.g., Tamil (Simple Design), with `['க', 'ச']` in a class), draw the bases `க`, `ச`, and the mark `ி`. 2. Position `ி` on `க` and save. 3. Verify that the card for `சி` (`ச`+`ி`) automatically becomes 'Positioned', showing `ி` with the same relative position as it has on `கி`.", "priority": "high" },
    {
        "id": "pos_class_applies_and_exceptions",
        "category": "Positioning Workspace",
        "description": "1. In `characters.json`, create a `baseAttachmentClass` with an `applies` list and an `exceptions` list (e.g., `applies: [markA, markB]`, `exceptions: [baseC]`). 2. Draw all relevant glyphs. 3. Position `markA` on `baseA` (which is in the class). 4. Verify `markA` is auto-positioned on `baseB`. 5. Verify `markB` is auto-positioned on `baseA` and `baseB`. 6. Verify no marks are auto-positioned on `baseC`. 7. Verify a `markC` (not in `applies`) is NOT auto-positioned on `baseA`.",
        "priority": "high"
    },
    { "id": "pos_mark_class_no_overwrite", "category": "Positioning Workspace", "description": "1. Following the `pos_mark_attachment_class_cascade` test, manually edit and save a different position for `கീ`. 2. Now, go back and re-adjust and save the position for `கி`. 3. Verify that the manually set position for `கീ` is *not* overwritten by the change to `கி`.", "priority": "high" },
    { "id": "pos_base_class_no_overwrite", "category": "Positioning Workspace", "description": "1. Following the `pos_base_attachment_class_cascade` test, manually edit and save a different position for `சி`. 2. Now, go back and re-adjust and save the position for `கி`. 3. Verify that the manually set position for `சி` is *not* overwritten by the change to `கி`.", "priority": "high" },
    { "id": "pos_base_mark_class_interaction", "category": "Positioning Workspace", "description": "1. For a script with both base and mark classes (e.g., Devanagari), draw `ग`, `म`, `ु`, `ू`. 2. Position `ु` on `ग`. 3. Verify that `मु` (`baseAttachmentClass` applies), `गू` (`markAttachmentClass` applies), and `मू` (both classes apply) are all pre-filled correctly.", "priority": "high" },
    { "id": "pos_editor_movement_constraint", "category": "Positioning Workspace", "description": "For a positioning rule with 'movement' set to 'horizontal' or 'vertical', open that pair in the editor. Using the Select tool, attempt to drag the mark. Verify its movement is constrained to the specified axis.", "priority": "medium" },
    { "id": "pos_accept_all_defaults", "category": "Positioning Workspace", "description": "In the Positioning workspace for a character with several un-positioned marks, click 'Accept All Defaults'. Verify all visible, un-positioned cards become 'Positioned' and corresponding dynamic ligatures are created.", "priority": "medium" },
    { "id": "pos_reuse_function", "category": "Positioning Workspace", "description": "Fully position all marks for one base character. Go to an un-positioned base character, click 'Reuse', and select the completed character. All corresponding mark positions should be copied.", "priority": "medium" },
    { "id": "pos_default_attachment", "category": "Positioning Workspace", "description": "For a script with `markAttachment` rules, open an un-positioned pair in the editor. The mark should appear at a default position based on the rule (e.g., top-center), not at the origin (0,0).", "priority": "medium" },
    { "id": "pos_component_deleted", "category": "Positioning Workspace", "description": "Position a mark on a base. Then, go to the Drawing workspace and delete the mark glyph. Return to Positioning. The combination card should now be disabled or reflect the missing glyph gracefully.", "priority": "medium" },
    { "id": "pos_empty_glyph_crash", "category": "Positioning Workspace", "description": "Position a mark on a base where the base glyph has valid metadata but NO drawn paths. The positioning editor should open without crashing (showing just the mark).", "priority": "medium" },
    { "id": "pos_mark_class_independence", "category": "Positioning Workspace", "description": "1. Ensure a script is loaded that has at least two separate `markAttachmentClass` groups (e.g., `[ु, ू]` and `[े, ै]`). 2. Position a mark from the first class (`ु`) on a base. 3. Verify that only other marks from the *same* class (`ू`) are pre-filled, and marks from the other class (`े`, `ै`) remain un-positioned.", "priority": "medium" },
    { "id": "pos_properties_panel_visibility", "category": "Positioning Workspace", "description": "ADVANCED: Load a script with both GPOS-based (`gpos` tag) and GSUB-based (`gsub` tag) positioning rules. Open the editor for a GPOS pair; the properties button (LSB/RSB) should be hidden. Open the editor for a GSUB pair; the properties button must be visible and functional.", "priority": "medium" },
    { "id": "pos_view_switch", "category": "Positioning Workspace", "description": "Switch between 'View by Base' and 'View by Mark'. The grouping of combination cards should update correctly.", "priority": "low" },
    { "id": "pos_ligature_map_override", "category": "Positioning Workspace", "description": "Create a custom script where a positioning rule's `ligatureMap` explicitly names a ligature (e.g., `k` + `i` -> `k_i_ligature`). Verify that when positioning this pair, the app creates a glyph with the name `k_i_ligature` instead of the default `ki`.", "priority": "low" },
    { "id": "pos_dynamic_ligature_generation", "category": "Positioning Workspace", "description": "1. Load a script with GSUB-based positioning rules. 2. Position a mark on a base to create a combination (e.g. 'k' + 'i'). 3. Save. 4. Go to the Drawing Workspace. 5. Verify that a new glyph (e.g. 'ki') has been created in the 'Positioned Glyphs' (or 'Dynamic Ligatures') tab.", "priority": "high" },
    { "id": "pos_incomplete_pair_warning", "category": "Positioning Workspace", "description": "In the Positioning workspace, load a script where some required base or mark glyphs are not yet drawn. Verify that an information banner appears stating 'Some potential combinations are hidden...'.", "priority": "medium" },

    { "id": "kern_edit_pair", "category": "Kerning Workspace", "description": "ADVANCED: Click a recommended pair. In the modal, enter a value (e.g., -50) and save. The card should update with the new value.", "priority": "high" },
    { "id": "kern_toggle_unkerned", "category": "Kerning Workspace", "description": "In the Kerning workspace, set a value for a few pairs. Enable the \"Show unkerned only\" toggle. Verify that the kerned pairs disappear from view. Disable the toggle and verify they reappear.", "priority": "high" },
    {
        "id": "kern_autokern_rule_based",
        "category": "Kerning Workspace",
        "description": "1. Create a custom script. In `positioning.json`, add `\"recommendedKerning\": [[\"A\", \"V\", 0]]`. 2. Draw 'A' and 'V' such that they have a default gap. 3. In the Kerning workspace, open the 'AV' pair and click 'Auto-kern'. 4. The kerning value should adjust so the x-height bounding boxes are just touching (a distance of 0).",
        "priority": "high"
    },
    { "id": "kern_drag_adjust", "category": "Kerning Workspace", "description": "ADVANCED: In the kerning adjustment modal, hover over the right-hand glyph until the 'ew-resize' cursor appears. Click and drag the glyph horizontally. The kerning value in the input field should update in real-time.", "priority": "medium" },
    { "id": "kern_xheight_input_adjust", "category": "Kerning Workspace", "description": "ADVANCED: In the kerning modal, note the value in the 'x-dist' input. Change it to a new number and press Enter. The main kerning value should change, and the visual spacing between the glyphs in the preview should update to reflect the new x-height distance.", "priority": "medium" },
    { "id": "kern_create_custom_pair", "category": "Kerning Workspace", "description": "ADVANCED: Use the Left/Right character selection panels to choose characters. A grid of new custom pairs should appear for editing.", "priority": "medium" },
    { "id": "kern_remove_kerning", "category": "Kerning Workspace", "description": "ADVANCED: Set a kerning value for a pair. Re-open the modal and click the trash icon. The kerning value should be removed.", "priority": "medium" },
    { "id": "kern_autokern_single", "category": "Kerning Workspace", "description": "ADVANCED: Open the modal for a single, un-kerned pair. Click the 'Auto-kern' button inside the modal. A calculated value should appear in the input field.", "priority": "medium" },
    { "id": "kern_autokern_filtered", "category": "Kerning Workspace", "description": "In \"All Pairs\" mode, use the side panels to filter the grid to a small subset of pairs. Click the main \"Auto-kern\" button. Verify that only the visible, un-kerned pairs receive new values, and other pairs remain untouched.", "priority": "medium" },
    { "id": "kern_autokern", "category": "Kerning Workspace", "description": "ADVANCED: With several un-kerned pairs visible, click 'Auto-kern'. The pairs should receive calculated kerning values.", "priority": "low" },
    { "id": "kern_extreme_values", "category": "Kerning Workspace", "description": "ADVANCED: In the kerning modal, enter a very large positive (e.g., 500) and a very large negative (e.g., -500) value. Verify the preview updates correctly and the value is saved.", "priority": "low" },
    { "id": "kern_search_functionality", "category": "Kerning Workspace", "description": "ADVANCED: In the kerning workspace, use the search bar in both the left and right character selection panels to filter the character lists.", "priority": "low" },
    { "id": "kern_simple_mode_ui", "category": "Kerning Workspace", "description": "For a script with kerning enabled (e.g., Malayalam), switch to \"Simple\" editor mode. Verify the workspace tab and modal titles change from \"Kerning\" to \"Spacing\". Confirm that adjusting values still functions correctly.", "priority": "low" },
    {
      "id": "kern_pagination",
      "category": "Kerning Workspace",
      "description": "In 'All Pairs' mode, select enough characters to generate more than 100 pairs (or 20 on mobile). Verify that pagination controls appear at the bottom and allow navigation between pages of pairs.",
      "priority": "medium"
    },

    { "id": "rules_lookup_flags", "category": "Rules Workspace (GUI)", "description": "ADVANCED: Manually edit the 'Lookup Flags' in the FEA code or via future GUI support. Export the font and verify that flags like 'IgnoreMarks' are respected in the generated OpenType tables (e.g., marks don't interfere with ligatures).", "priority": "high" },
    {
        "id": "rules_lookup_lifecycle_and_ordering",
        "category": "Rules Workspace (GUI)",
        "description": "1. Create two glyphs: 'A', 'B'. 2. In Lookups pane, create 'lookup_1' and add a rule `sub A by B;`. 3. In Features pane, for feature `liga`, add an inline rule `sub B by A;`. 4. Add a reference to 'lookup_1'. 5. Use the arrows to move 'lookup_1' *before* the inline rules. 6. Export font and test: typing 'A' should result in 'A' (A -> B -> A). 7. Go back, move 'lookup_1' *after* inline rules. 8. Export and test: typing 'A' should result in 'B' (B -> A -> B). 9. Rename 'lookup_1' to 'my_lookup'. Verify the reference in `liga` is updated. 10. Delete 'my_lookup'. Verify it's gone from the `liga` feature.",
        "priority": "high"
    },
    { "id": "rules_lookup_reorder", "category": "Rules Workspace (GUI)", "description": "1. In the Rules workspace, ensure a feature has multiple lookup references. 2. Use the Up/Down arrows next to a lookup reference. 3. Verify the order changes in the UI. 4. Export FEA/font and verify the execution order matches the UI.", "priority": "medium" },
    { "id": "rules_add_ligature_sub", "category": "Rules Workspace (GUI)", "description": "ADVANCED: Add a Ligature Substitution rule (e.g., replace a sequence of glyphs with a single ligature glyph).", "priority": "high" },
    { "id": "rules_add_contextual_sub", "category": "Rules Workspace (GUI)", "description": "ADVANCED: Add a Contextual Substitution rule (e.g., replace a glyph only when it is next to another specific glyph).", "priority": "high" },
    { "id": "rules_use_group_in_rule", "category": "Rules Workspace (GUI)", "description": "ADVANCED: In the 'Groups' sub-tab of the Rules workspace, create a new group '@test_group' with members 'a' and 'b'. Switch to the main GUI editor and create a single substitution rule: `sub @test_group by c;`. Export the font and test that both 'a' and 'b' are replaced by 'c'.", "priority": "high" },
    {
        "id": "rules_glyphselect_component_usage",
        "category": "Rules Workspace (GUI)",
        "description": "In the 'Add New Rule' form for each rule type (ligature, single, etc.), use the `<GlyphSelect>` dropdown/search component to select input and output glyphs. Also test selecting a group (e.g., @virama). Verify the rule can be saved correctly with the selected glyphs/groups.",
        "priority": "high"
    },
    { "id": "rules_stress_large_group", "category": "Rules Workspace (GUI)", "description": "Create a glyph group (e.g., `@mycons`) and use it in a substitution rule. Then, delete the `@mycons` group from the Groups pane. Verify the rule that used it is handled gracefully (e.g., flagged as invalid, ignored on export) without crashing the app.", "priority": "medium" },
    { "id": "rules_replace_existing_glyph", "category": "Rules Workspace (GUI)", "description": "ADVANCED: In any rule editor (ligature, contextual, etc.), click on a glyph that has already been placed in a slot. Verify the selection modal opens, allowing the glyph to be replaced.", "priority": "high" },
    { "id": "rules_group_pane_lifecycle", "category": "Rules Workspace (GUI)", "description": "ADVANCED: In the Rules workspace, switch to the 'Groups' tab. Create a new group, add members, and save it. Then, edit the group to change its name and members. Finally, delete the group. Verify all operations succeed.", "priority": "high" },
    { "id": "rules_group_lifecycle", "category": "Rules Workspace (GUI)", "description": "1. Navigate to the 'Groups' sub-tab in Rules workspace. 2. Create a new group '@test'. 3. Add members. 4. Save. 5. Go to GUI rules and use '@test' in a rule. 6. Go back to Groups tab and delete '@test'. 7. Verify the rule editor handles the missing group gracefully.", "priority": "high" },
    { "id": "rules_circular_group_dependency", "category": "Rules Workspace (GUI)", "description": "Create group @A containing @B. Create group @B containing @A. Verify app handles/prevents infinite loop/crash.", "priority": "medium" },
    { "id": "rules_lookup_delete_reference", "category": "Rules Workspace (GUI)", "description": "Delete a lookup definition that is referenced by a feature. Verify reference is removed or handled gracefully in Feature view.", "priority": "medium" },
    { "id": "rules_invalid_ligature_error", "category": "Rules Workspace (GUI)", "description": "ADVANCED: Attempt to save a ligature rule with no input components or no output glyph. Verify an error notification appears.", "priority": "high" },
    { "id": "rules_invalid_contextual_error", "category": "Rules Workspace (GUI)", "description": "ADVANCED: Attempt to save a contextual rule missing a target, a replacement, or both left/right context. Verify an error notification appears.", "priority": "high" },
    { "id": "rules_invalid_multiple_error", "category": "Rules Workspace (GUI)", "description": "ADVANCED: Attempt to save a multiple substitution rule with no input or no output glyphs. Verify an error notification appears.", "priority": "high" },
    { "id": "rules_invalid_single_error", "category": "Rules Workspace (GUI)", "description": "ADVANCED: Attempt to save a single substitution rule with no input or no output glyph. Verify an error notification appears.", "priority": "high" },
    { "id": "rules_invalid_dist_simple_error", "category": "Rules Workspace (GUI)", "description": "ADVANCED: Attempt to save a simple distance rule with no target character. Verify an error notification appears.", "priority": "high" },
    { "id": "rules_invalid_dist_contextual_error", "category": "Rules Workspace (GUI)", "description": "ADVANCED: Attempt to save a contextual distance rule with no target or no context glyphs. Verify an error notification appears.", "priority": "high" },
    { "id": "rules_dist_simple_lifecycle", "category": "Rules Workspace (GUI)", "description": "ADVANCED: In the 'dist' feature, add, edit the value of, and then delete a simple GPOS rule.", "priority": "high" },
    { "id": "rules_dist_contextual_lifecycle", "category": "Rules Workspace (GUI)", "description": "ADVANCED: In the 'dist' feature, add, edit (change context/target/value), and then delete a contextual GPOS rule.", "priority": "high" },
    { "id": "rules_glyph_selection_for_dist_rules", "category": "Rules Workspace (GUI)", "description": "ADVANCED: In the distance (GPOS) rule editor, click on an empty glyph slot. Verify the glyph selection modal opens and a glyph can be selected.", "priority": "high" },
    { "id": "rules_add_single_sub", "category": "Rules Workspace (GUI)", "description": "ADVANCED: Add a Single Substitution rule (e.g., replace one glyph with another).", "priority": "medium" },
    { "id": "rules_add_multiple_sub", "category": "Rules Workspace (GUI)", "description": "ADVANCED: Add a Multiple Substitution rule (e.g., replace one glyph with a sequence of two or more).", "priority": "medium" },
    { "id": "rules_edit_delete", "category": "Rules Workspace (GUI)", "description": "ADVANCED: Edit an existing rule by changing its components/output. Then, delete the rule using its delete button. The 'Delete Rule?' confirmation should appear.", "priority": "medium" },
    { "id": "rules_with_undrawn_glyphs", "category": "Rules Workspace (GUI)", "description": "ADVANCED: Create a valid rule using at least one glyph that has not been drawn. A warning should be visible in the UI, and the rule should not apply when testing or exporting the font.", "priority": "medium" },
    { "id": "rules_rename_tags", "category": "Rules Workspace (GUI)", "description": "In the Rules workspace, click the edit icon next to the main script tag (e.g., `dev2`) and rename it (e.g., to `deva`). Then, select a feature and click its edit icon to rename it (e.g., `akhn` to `liga`). Verify all rules are preserved under the new names and the font exports correctly.", "priority": "medium" },
    { "id": "rules_group_delete_cascade", "category": "Rules Workspace (GUI)", "description": "ADVANCED: Create a glyph group (e.g., `@mycons`) and use it in a substitution rule. Then, delete the `@mycons` group from the Groups pane. Verify the rule that used it is handled gracefully (e.g., flagged as invalid, ignored on export) without crashing the app.", "priority": "medium" },
    { "id": "rules_add_feature", "category": "Rules Workspace (GUI)", "description": "ADVANCED: Click the '+' button in the feature tab list. Add a new valid feature tag (e.g., 'calt'). The new feature tab should appear.", "priority": "low" },
    { "id": "rules_drag_drop_glyph", "category": "Rules Workspace (GUI)", "description": "In the Rule Editor, drag a glyph name from the 'Glyph Groups' pane (or simulate if possible) and drop it into a rule input slot. Verify the slot populates correctly.", "priority": "medium" },

    { "id": "fea_edit_code", "category": "Rules Workspace (FEA Code)", "description": "ADVANCED: Click 'Edit Manually'. The FEA editor should become active. Make a change, and verify it persists.", "priority": "high" },
    { "id": "fea_revert_to_gui", "category": "Rules Workspace (FEA Code)", "description": "ADVANCED: In manual FEA mode, click 'Revert to GUI'. The confirmation modal should appear. Confirming should re-enable the GUI editor and discard manual FEA changes.", "priority": "medium" },
    { "id": "fea_code_generation", "category": "Rules Workspace (FEA Code)", "description": "ADVANCED: In the GUI, create one of each rule type (liga, contextual), set one kerning pair, and position one mark. Switch to the FEA code view (without entering manual mode). Verify that `feature liga`, `feature kern`, `feature mark`, etc., have been generated with the correct syntax.", "priority": "medium" },
    { "id": "fea_export_button", "category": "Rules Workspace (FEA Code)", "description": "ADVANCED: In the Rules workspace, click the 'Export FEA' button. A .fea file containing the generated code should be downloaded.", "priority": "medium" },
    { "id": "fea_unicode_vs_name_reference", "category": "Rules Workspace (FEA Code)", "description": "ADVANCED: In manual FEA mode, write a rule referring to a glyph by its friendly name (e.g., 'sub ka by sa;') instead of its `uniXXXX` name. Export the font. Verify a compilation error occurs.", "priority": "medium" },
    { "id": "fea_gui_regeneration_after_revert", "category": "Rules Workspace (FEA Code)", "description": "ADVANCED: Enter manual FEA mode, make a change. Revert to GUI mode. In the GUI, add a new simple rule. Switch back to the FEA code view and verify the generated code includes the new rule and has discarded the manual changes.", "priority": "medium" },
    { "id": "metrics_bulk_edit", "category": "Metrics Workspace", "description": "1. Go to Metrics Workspace. 2. Click 'Edit'. 3. Select multiple glyphs. 4. Click 'Edit Properties'. 5. Change the Left Side Bearing. 6. Save. 7. Verify all selected glyphs have the new LSB value.", "priority": "high" },
    { "id": "metrics_selection_visuals", "category": "Metrics Workspace", "description": "Click a glyph. Verify border change/checkmark. Click again to deselect.", "priority": "medium" },
    { "id": "metrics_bulk_edit_partial", "category": "Metrics Workspace", "description": "Select 2 glyphs. Bulk edit. Change only LSB (leave RSB blank). Verify only LSB updated.", "priority": "medium" },
    {
        "id": "metrics_upm_scaling",
        "category": "Settings & Properties Panels",
        "description": "ADVANCED: Change the 'Units Per Em' in Settings (e.g., from 1000 to 2048). Export the font. Verify that the characters are not visibly tiny or huge compared to standard fonts, ensuring the app scales drawing coordinates to the new UPM correctly.",
        "priority": "medium"
    },
    {
      "id": "settings_metrics_visualizer_update",
      "category": "Settings & Properties Panels",
      "description": "In Metrics Settings, change the Ascender and Descender values. Verify that the visual diagram above the inputs updates in real-time to reflect the new proportions.",
      "priority": "low"
    },

    { "id": "export_successful", "category": "Final Views & Export", "description": "With a reasonably complete set of glyphs drawn, click 'Export OTF'. A valid, installable .otf font file should download.", "priority": "high" },
    { "id": "export_metadata_check", "category": "Final Views & Export", "description": "In Settings, fill out Font Meta Data (Designer, License, etc.). Export the font, install it, and check its properties in your OS to confirm the metadata is embedded correctly.", "priority": "high" },
    { "id": "export_required_glyphs", "category": "Final Views & Export", "description": "Export a font with at least one drawn character. Use an external font editor (like FontForge or Glyphs) to inspect the OTF file. Verify that: 1. A `.notdef` glyph exists and has a visible shape (e.g., a rectangle). 2. Glyphs for 'space', ZWJ (U+200D), and ZWNJ (U+200C) exist. 3. The advance width for ZWJ and ZWNJ is exactly 0.", "priority": "high" },
    { "id": "export_with_custom_script_fea", "category": "Final Views & Export", "description": "Create a custom script project that uses a manually uploaded FEA file. Draw the necessary glyphs. Export the OTF. Install and test the font to verify the custom FEA features are working.", "priority": "high" },
    { "id": "export_font_cache_hit", "category": "Final Views & Export", "description": "Click 'Test' to generate a font. Close the test page. Without making any changes, click 'Test' again. The font should load almost instantly, skipping the 'Generating font...' notification.", "priority": "high" },
    { "id": "export_font_cache_invalidation_glyph_change", "category": "Final Views & Export", "description": "Test a font. Return to the editor and make a visible change to a glyph. Test the font again. The 'Generating font...' notification must appear, and the preview must show the updated glyph.", "priority": "high" },
    { "id": "export_offline_resilience", "category": "Final Views & Export", "description": "Simulate an offline state (disconnect internet). Attempt to export a font. Verify the application provides a graceful error message if the Python environment cannot be loaded, rather than crashing.", "priority": "high" },
    {
        "id": "export_smp_glyph_name",
        "category": "Final Views & Export",
        "description": "1. Add a Supplementary Multilingual Plane (SMP) character (e.g., U+1F600, 😀). 2. Draw something for it. 3. Export the OTF font. 4. Inspect the font file with an external tool. 5. Verify the glyph exists and is named `u1F600` (not `uni1F600`).",
        "priority": "medium"
    },
    { "id": "export_empty_font_error", "category": "Final Views & Export", "description": "Start a new project and click 'Export OTF' without drawing any glyphs. An error notification should appear, and no file should be downloaded.", "priority": "medium" },
    {
        "id": "export_empty_touched_glyph",
        "category": "Final Views & Export",
        "description": "1. Open the editor for a character. 2. Draw a single dot and then immediately clear the canvas. 3. Save the now-empty glyph. 4. Export the OTF font. 5. Inspect the font file to verify that this character is *not* included in the final font.",
        "priority": "medium"
    },
    { "id": "export_incomplete_warning", "category": "Final Views & Export", "description": "Draw only one character and click 'Export OTF'. The 'Incomplete Font Warning' modal should appear. Test 'Export Anyway'.", "priority": "medium" },
    { "id": "export_fea_error_warning", "category": "Final Views & Export", "description": "ADVANCED: In manual FEA mode, enter invalid syntax (e.g., 'sub a b c;') and click 'Export OTF'. The 'OpenType Feature Error' modal must appear. Test the 'Export Anyway' button to confirm that a basic font file (without advanced features) is still downloaded.", "priority": "medium" },
    { "id": "export_font_name_special_chars", "category": "Final Views & Export", "description": "Set a font name that includes spaces and special characters (e.g., \"My Awesome Font!\"). Export the OTF. The downloaded filename should be sanitized (e.g., \"my_awesome_font_.otf\"), but the internal font name should be correct.", "priority": "medium" },
     {
        "id": "export_name_table_verification",
        "category": "Final Views & Export",
        "description": "Change the Font Name, Designer, and Manufacturer in Settings. Export the OTF. Open the file in a font viewer or info tool. Verify that the Naming Table fields (Family Name, Full Name, Unique ID) match your input exactly.",
        "priority": "medium"
    },
    { "id": "view_font_test_page", "category": "Final Views & Export", "description": "Click the 'Test' icon. The Font Test Page should open and render a preview. Type text and adjust size/line-height sliders.", "priority": "medium" },
    { "id": "view_comparison_page", "category": "Final Views & Export", "description": "ADVANCED: Open the Comparison View. Select characters from the sidebar. Test the wrap/unwrap toggle and zoom controls.", "priority": "medium" },
    { "id": "view_comparison_large_selection", "category": "Final Views & Export", "description": "ADVANCED: In Comparison View, select a large number of characters (>50). Verify the view remains performant when scrolling and zooming, both in wrapped and unwrapped modes.", "priority": "medium" },
    { "id": "view_test_case_page", "category": "Final Views & Export", "description": "From the 'More' menu, open the Test Case page. Mark several tests as 'Pass' and 'Fail'. Refresh the page. The statuses should be preserved. Test the priority filters and the 'Reset All' button.", "priority": "medium" },
    { "id": "data_integrity_load_invalid_project", "category": "Complex Integration & Data Integrity", "description": "Manually edit a saved project JSON file to introduce invalid data (e.g., a path with a `null` point, a kerning pair with a non-existent unicode). Attempt to load the file. The app should handle the error gracefully without crashing.", "priority": "high" },
    { "id": "data_integrity_delete_used_glyph", "category": "Complex Integration & Data Integrity", "description": "ADVANCED: Create a kerning pair and a substitution rule using glyph 'A'. Then, delete glyph 'A'. Verify the kerning pair is removed and the substitution rule is handled gracefully (e.g., disabled or removed) without crashing.", "priority": "high" },
    { "id": "integration_fea_override_kerning", "category": "Complex Integration & Data Integrity", "description": "ADVANCED: Set a kerning value of -50 for 'AV' in the Kerning workspace. Then, in manual FEA mode, write a `kern` feature that sets the value for 'AV' to -100. Export the font and verify the -100 value takes precedence.", "priority": "high" },
    { "id": "integration_autosave_during_drag", "category": "Complex Integration & Data Integrity", "description": "Enable Autosave. In the drawing editor, start dragging a point or path but do not release the mouse. While dragging, refresh the browser page. Restore the session. Verify the glyph state is restored to the state *before* the drag began, not a corrupted intermediate state.", "priority": "high" },
    { "id": "data_sync_glyph_edit_to_views", "category": "Complex Integration & Data Integrity", "description": "Edit a base glyph (e.g., 'க'). Verify the updated drawing appears immediately in the main grid, Positioning cards, Kerning cards, Rules palette, and Comparison View.", "priority": "high" },
    { "id": "data_sync_kerning_to_test", "category": "Complex Integration & Data Integrity", "description": "Set a kerning value for a pair. Open the Font Test Page and type the pair. The kerning should be visibly applied.", "priority": "high" },
    { "id": "data_sync_positioning_to_test", "category": "Complex Integration & Data Integrity", "description": "Adjust the position of a mark. Open the Font Test Page and type the base+mark combination. The new position should be correctly rendered.", "priority": "high" },
    { "id": "data_sync_rule_to_test", "category": "Complex Integration & Data Integrity", "description": "Create a new substitution rule (e.g., sub A by B). Open the Font Test Page and type 'A'. It should render as 'B'.", "priority": "high" },
    { "id": "data_sync_glyph_edit_to_autosave", "category": "Complex Integration & Data Integrity", "description": "Enable Autosave. Open a glyph, make a change, and immediately navigate to a different glyph. Then, refresh the page and restore the session. Verify the change to the first glyph was saved.", "priority": "high" },
    { "id": "pos_reuse_creates_dynamic_ligatures", "category": "Complex Integration & Data Integrity", "description": "Position all marks for a base character (e.g., 'க'). Use the 'Reuse' feature to copy these positions to a second base character (e.g., 'ச'). Verify that new dynamic ligature glyphs for the second character (e.g., 'சி', 'சீ') are created and appear in the Drawing workspace. Export and test the font to confirm these new ligatures render correctly.", "priority": "high" },
    { "id": "ui_positioned_glyph_in_rule_editor_modal", "category": "Complex Integration & Data Integrity", "description": "1. Go to Positioning workspace and position a mark on a base, creating a new dynamic ligature (e.g., 'கி'). 2. Go to the Rules workspace and open the glyph selection modal. 3. Verify that the newly created dynamic ligature ('கி') is visible and selectable in the modal.", "priority": "high" },
    { "id": "data_pua_auto_assignment", "category": "Complex Integration & Data Integrity", "description": "1. Create a Custom Script with a `characters.json` file where one character has no `unicode` property. 2. Start the project. 3. Open the Drawing modal for that character. 4. Verify in the UI (Advanced mode header) that it has been assigned a PUA codepoint (U+E000 or higher). 5. Add another character without a unicode via the `characters.json` and reload, verifying it gets the next sequential PUA codepoint.", "priority": "high" },
    { "id": "data_dynamic_ligature_pua_assignment", "category": "Complex Integration & Data Integrity", "description": "1. Load a script with a `rules.json` that defines a ligature (e.g., `ksh`) whose components (`k`, `sh`) exist but the ligature itself is not in `characters.json`. 2. Do *not* draw the ligature. 3. Export the font. 4. Open the exported OTF in a font editor. 5. Verify that a glyph for the ligature (`ksh`) was created and assigned a PUA codepoint separate from any user-defined PUAs.", "priority": "high" },
    {
        "id": "data_pua_stability_reload",
        "category": "Complex Integration & Data Integrity",
        "description": "Create a project with custom glyphs that are assigned PUA codepoints. Export the project to JSON. Clear the browser data or use a new session, then import the project JSON. Verify that the custom glyphs retain the exact same PUA codepoint as before.",
        "priority": "high"
    },
    {
        "id": "data_pua_collision_avoidance",
        "category": "Complex Integration & Data Integrity",
        "description": "1. Manually add a custom glyph and assign it codepoint U+E000. 2. Have a rule that will dynamically generate a ligature (which would normally get U+E000). 3. Export the font. 4. Verify in a font editor that the manually added glyph has U+E000 and the dynamic ligature was assigned the next available PUA (U+E001).",
        "priority": "medium"
    },
    { "id": "data_mode_switch_preservation", "category": "Complex Integration & Data Integrity", "description": "In Advanced mode, create several complex rules and kerning pairs. Switch to Simple mode (which hides these workspaces). Save the project. Reload the app and the project. Switch back to Advanced mode. Verify all rules and kerning pairs are still present and correct.", "priority": "high" },
    { "id": "integration_positioning_gsub_vs_gpos", "category": "Complex Integration & Data Integrity", "description": "ADVANCED: For a positioning rule with `gsub` defined, editing a pair should create/update a dynamic ligature glyph in `glyphDataMap`. For a rule with `gpos` defined (but no `gsub`), editing a pair should only save the offset to `markPositioningMap` and *not* create a new composite glyph in the main drawing grid.", "priority": "high" },
    { "id": "integration_custom_glyph_lifecycle", "category": "Complex Integration & Data Integrity", "description": "ADVANCED: Add a new custom glyph. Draw it. Use it as a component and as an output in a substitution rule. Set a kerning value for it. Use it in the Positioning editor. Export the font. Verify all features involving the custom glyph work.", "priority": "medium" },
    {
        "id": "import_missing_components",
        "category": "Complex Integration & Data Integrity",
        "description": "In 'Import Glyphs', select a composite/linked glyph (e.g., 'க்') from a source project, but do *not* select its base components ('க', '்'). Import. Verify how the app handles the missing dependencies (Does it import them implicitly? Create empty placeholders? Or break?).",
        "priority": "high"
    },
    { "id": "data_integrity_component_bearing_change", "category": "Complex Integration & Data Integrity", "description": "ADVANCED: Change the LSB/RSB of a component glyph (e.g., 'க'). Open a composite glyph that uses it (e.g., 'க்') and verify if its auto-calculated width and bearings adjust appropriately, or if it remains static as designed.", "priority": "medium" },
    { "id": "data_pua_restore", "category": "Complex Integration & Data Integrity", "description": "In a custom script, create a character without a Unicode value, forcing a PUA assignment. Save the project. Load the project in a new session. Verify the character is restored with its correct PUA value and drawing.", "priority": "medium" },
    { "id": "settings_general_autosave_toggle", "category": "Settings & Properties Panels", "description": "In General Settings, toggle 'Enable Autosave' off. Make a change in the drawing editor and attempt to close it. The 'Unsaved Changes' modal must appear. Toggle it back on and repeat; the modal should not appear and changes should save.", "priority": "high" },
    { "id": "settings_metadata_all_fields", "category": "Settings & Properties Panels", "description": "In Font Meta Data Settings, populate every single field (Manufacturer, Designer, Description, all URLs, License info). Export the font, install it, and check its properties in your OS to confirm the metadata is embedded correctly.", "priority": "high" },
    { "id": "settings_metrics_all_fields", "category": "Settings & Properties Panels", "description": "ADVANCED: In Metrics Settings, modify every field (Units Per Em, Style Name, Space Advance, Default LSB/RSB, etc.). Export the font and inspect its properties in an external font editor to confirm all metrics are applied.", "priority": "high" },
    {
        "id": "settings_debug_kerning_toggle",
        "category": "Settings & Properties Panels",
        "description": "1. In General Settings, enable the 'Debug Kerning Bounding Boxes' toggle. 2. Go to the Kerning workspace and open the modal for any pair. 3. Verify that colored rectangles (blue for ascender, green for x-height, red for descender) are visible overlaid on the glyphs. 4. Go back to settings, disable the toggle, and re-open the kerning modal. 5. Verify the debug rectangles are no longer visible.",
        "priority": "medium"
    },
    { "id": "settings_test_page_defaults", "category": "Settings & Properties Panels", "description": "In Test Page Settings, set a custom default Font Size and Line Height. Open the Font Test page and confirm the sliders and initial preview use these new default values.", "priority": "medium" },
    { "id": "settings_positioning_lsb_rsb", "category": "Settings & Properties Panels", "description": "ADVANCED: In the Positioning editor for a combination, open the properties panel and set a custom LSB and RSB. Export the font and verify the resulting ligature glyph has the correct, custom side bearings.", "priority": "medium" },
    { "id": "settings_general_path_smoothing", "category": "Settings & Properties Panels", "description": "In General Settings, change the 'Path Smoothing' value. Draw a complex freehand shape and confirm the level of detail changes according to the setting.", "priority": "low" },
    { "id": "settings_general_background_hints", "category": "Settings & Properties Panels", "description": "In General Settings, toggle 'Show Background Hints'. Open the drawing editor and verify the large, grey character name in the background appears and disappears.", "priority": "low" },
    {
      "id": "settings_theme_persistence",
      "category": "Settings & Properties Panels",
      "description": "Switch to Dark Mode. Refresh the page or close/reopen the browser. Verify that the application remains in Dark Mode without reverting to Light Mode.",
      "priority": "low"
    },
    { "id": "a11y_modal_focus_trap", "category": "Accessibility", "description": "When a modal is open, continuously press the Tab key. The focus should cycle through the interactive elements within the modal and not escape to the background page content.", "priority": "high" },
    { "id": "a11y_screen_reader_labels", "category": "Accessibility", "description": "Using a screen reader, navigate through the main header buttons and workspace tabs. Verify they have descriptive labels (e.g., \"Save project\", \"Drawing workspace\").", "priority": "medium" },
    { "id": "a11y_keyboard_rule_editor", "category": "Accessibility", "description": "ADVANCED: Navigate the GUI Rule Editor using only the keyboard. Verify it's possible to add a new rule, tab to the drop zones, and (if possible) select glyphs without a mouse.", "priority": "medium" },
    { "id": "a11y_screen_reader_test_status", "category": "Accessibility", "description": "Using a screen reader, navigate to a test case in the Test Case page and activate the Pass/Fail buttons. Verify the screen reader announces the action and the updated status of the test case.", "priority": "medium" },
    { "id": "perf_memory_leak_check", "category": "Performance", "description": "Open and close the glyph drawing modal for 20 different characters. Monitor browser memory usage. There should not be a significant, sustained increase in memory after closing all modals.", "priority": "medium" },
    { "id": "perf_large_glyph_set", "category": "Performance", "description": "Simulate or load a project with 500+ glyphs defined. Measure the performance of the main Character Grid when scrolling and switching between character sets.", "priority": "medium" },
    { "id": "perf_large_rule_set_export", "category": "Performance", "description": "ADVANCED: Create a project with >200 kerning pairs and >50 complex substitution rules. Measure the time it takes to generate the FEA code and export the final OTF.", "priority": "medium" },
    {
        "id": "draw_relink_glyph_behavior",
        "category": "Drawing Workspace: Glyph Management",
        "description": "1. Unlock a linked glyph (e.g., 'க்'). 2. Manually draw a stroke on it. 3. Click the 'Relink' button in the toolbar. 4. Confirm the warning modal. 5. Verify that the manual stroke is removed and the glyph reverts to displaying its locked components ('க' + '்').",
        "priority": "high"
    },
    {
        "id": "ui_notification_undo_action",
        "category": "General UI & Navigation",
        "description": "1. In the Positioning workspace, move a mark for a base character that triggers a cascade update (e.g., a class-based update). 2. Verify a success notification appears with an 'UNDO' button. 3. Click 'UNDO'. 4. Verify that the positioning change is reverted for both the current pair and all cascaded pairs.",
        "priority": "medium"
    },
    {
        "id": "draw_cascading_shape_update_with_transform",
        "category": "Drawing Workspace: Glyph Management",
        "description": "1. Create/Find a composite glyph that uses a scaled component (e.g., `compositeTransform: [[0.7, 0]]`). 2. Edit the source component's shape (e.g., add a circle). 3. Save and confirm update. 4. Verify the composite glyph shows the *new* shape (circle) but still applied with the 0.7 scale factor.",
        "priority": "high"
    },
    {
        "id": "draw_undo_redo_persistence",
        "category": "Drawing Workspace: Editor & Tools",
        "description": "1. Enable Autosave. 2. Draw a shape. 3. Autosave triggers. 4. Click Undo. 5. Autosave triggers again. 6. Refresh page and restore session. 7. Verify the state *after* undo is restored.",
        "priority": "medium"
    },
    {
        "id": "ui_notification_undo_cascade",
        "category": "General UI & Navigation",
        "description": "1. Trigger a cascade update (e.g., by editing a base glyph used in many ligatures). 2. Click the 'Undo' button on the success notification. 3. Verify that the changes to the base glyph AND all dependent ligatures are reverted.",
        "priority": "high"
    },
    {
        "id": "draw_boolean_union_holes",
        "category": "Drawing Workspace: Editor & Tools",
        "description": "ADVANCED: Use 'Trace Image' to import a shape with a hole (e.g., letter 'O'). Verify that the resulting path is a single compound path with the hole correctly subtracted (winding rule check).",
        "priority": "medium"
    },
    {
        "id": "settings_guide_font_rendering",
        "category": "Settings & Properties Panels",
        "description": "1. In `scripts.json`, configure a `guideFont` URL. 2. Load the script. 3. Verify the guide font renders correctly in the Drawing Editor background (faint hint) and on character cards.",
        "priority": "medium"
    },
    {
        "id": "export_fea_compilation_failure_handling",
        "category": "Final Views & Export",
        "description": "ADVANCED: Enter invalid FEA code in manual mode. Click Export. Verify that the app does not crash/freeze, but instead shows the specific Pyodide error message in a modal, allowing the user to export the un-patched font anyway.",
        "priority": "high"
    },
    { "id": "view_font_test_page", "category": "Final Views & Export", "description": "Click the 'Test' icon. The Font Test Page should open and render a preview. Type text and adjust size/line-height sliders.", "priority": "medium" },
    { "id": "view_font_test_persistence_and_reset", "category": "Final Views & Export", "description": "Open the Font Test Page. Modify the font size, line height, and input text. Close the modal and re-open it; verify your changes persisted. Click the 'Reset' button (undo icon) in the header; verify that size, height, and text revert to the script defaults.", "priority": "medium" },
    { "id": "kerning_pair_generation", "category": "Kerning", "description": "Go to Kerning Workspace. Switch to 'All Pairs' tab. Select at least one character from the Left panel and one from the Right panel. Verify that a pair card appears in the grid representing that combination.", "priority": "high" },
    { "id": "kerning_auto_kern_batch", "category": "Kerning", "description": "In Kerning grid view with unkerned pairs visible, click the 'Auto-kern' button in the toolbar. Verify that the app calculates values and the pair cards update with new numeric values.", "priority": "medium" },
    { "id": "kerning_manual_interaction", "category": "Kerning", "description": "Open a pair in the Kerning Editor. Drag the right glyph horizontally. Verify that the glyph moves and the 'Kerning' input value updates in real-time. Click 'Save' (or verify Autosave).", "priority": "high" },
    { "id": "kerning_x_distance_logic", "category": "Kerning", "description": "In the Kerning Editor, hover over the gap between glyphs to see the green X-Distance line. Modify the 'x-dist' input field value in the header. Verify that the main 'Kerning' value updates automatically to achieve the desired optical distance.", "priority": "medium" },
    { "id": "kerning_editor_navigation", "category": "Kerning", "description": "Open a pair in the Kerning Editor. Use the Left/Right arrow buttons (or keyboard keys) to switch to the next pair without closing the editor. Verify that the previous pair's changes are saved.", "priority": "medium" },
    { "id": "kerning_reset_actions", "category": "Kerning", "description": "Test the 'Delete' (Trash icon) in the Editor to reset a single pair to 0. Back in the grid, test the 'Reset Visible' button to clear all kerning for the currently filtered view.", "priority": "low" },
    {
        "id": "data_integrity_linked_source_deletion",
        "category": "Complex Integration & Data Integrity",
        "description": "1. Create Glyph 'A'. 2. Create Glyph 'B' and link it to 'A' (Locked). 3. Delete Glyph 'A'. 4. Verify Glyph 'B' exists, is now Unlocked (editable), and retains 'A's paths.",
        "priority": "high"
    },
    {
        "id": "data_integrity_composite_source_deletion",
        "category": "Complex Integration & Data Integrity",
        "description": "1. Create Glyph 'X'. 2. Create Glyph 'Y' as a Composite of 'X' (Prefilled). 3. Delete Glyph 'X'. 4. Verify Glyph 'Y' retains its paths. 5. Verify Glyph 'Y' no longer has the 'composite' property in metadata (it acts as a base glyph).",
        "priority": "high"
    },
    {
        "id": "data_integrity_cascade_chain_deletion",
        "category": "Complex Integration & Data Integrity",
        "description": "1. Setup Linked Chain: A -> B (Linked to A) -> C (Linked to B). 2. Delete Glyph B. 3. Verify Glyph C converts to a base glyph, retaining its shape, and does not crash the app.",
        "priority": "medium"
    },
    { "id": "project_save_as_copy", "category": "App Initialization & File I/O", "description": "Open the 'More' menu and select 'Save Copy...'. Enter a new name 'MyFont v2'. Confirm. Verify the project name in the header updates to 'MyFont v2' and a new entry is created in the database (check Recent Projects after backing out).", "priority": "high" },
    {
      "id": "group_sync_pos_to_rules",
      "category": "Complex Integration & Data Integrity",
      "description": "1. In Positioning Workspace -> Manage Rules -> Groups, create a new group '@test_pos_sync' with members. 2. Save. 3. Switch to Rules Workspace -> Glyph Groups. 4. Verify '@test_pos_sync' is visible and editable. 5. Check 'FEA Code' tab to ensure `@test_pos_sync = [...];` is generated.",
      "priority": "high"
    },
    {
      "id": "group_sync_rules_to_pos",
      "category": "Complex Integration & Data Integrity",
      "description": "1. In Rules Workspace -> Glyph Groups, create a new group '@test_rules_sync'. 2. Switch to Positioning Workspace -> Manage Rules -> Groups. 3. Verify '@test_rules_sync' is visible and editable there.",
      "priority": "medium"
    },
    {
      "id": "pos_manager_rule_lifecycle",
      "category": "Positioning Workspace",
      "description": "In 'Manage Rules' > 'Rules & Anchors': 1. Add a new Positioning Rule (Base: [A], Mark: [B]). 2. Save. 3. Edit the rule (Add Base [C], change GPOS tag). 4. Save. 5. Delete the rule. 6. Verify changes persist at each step.",
      "priority": "high"
    },
    {
      "id": "pos_manager_class_lifecycle",
      "category": "Positioning Workspace",
      "description": "In 'Manage Rules' > 'Groups & Classes': 1. Create a Mark Class. 2. Add members. 3. Add an 'Applies To' filter (e.g. restrict to specific bases). 4. Save. 5. Create a Base Class with 'Exceptions'. 6. Save. 7. Verify classes are listed correctly.",
      "priority": "high"
    },
    {
      "id": "pos_manager_anchor_lifecycle",
      "category": "Positioning Workspace",
      "description": "In 'Manage Rules' > 'Rules & Anchors': 1. Add a Manual Anchor definition. 2. Select Base/Mark and specific anchor points (e.g. TopRight -> BottomLeft). 3. Add X/Y offsets. 4. Save. 5. Verify it appears in the list. 6. Verify the positioning of that specific pair in the main grid updates to reflect these manual offsets.",
      "priority": "high"
    },
    {
      "id": "rules_group_smart_input",
      "category": "Rules Workspace (GUI)",
      "description": "In the Group Editor (Rules or Positioning): 1. Start typing '$' in the members input. 2. Verify autocomplete shows Character Sets (e.g. $vowels). 3. Start typing '@'. 4. Verify autocomplete shows existing Groups. 5. Select one of each and save. 6. Verify the group expands correctly when used in a rule.",
      "priority": "medium"
    },
    {
      "id": "fea_class_reference_generation",
      "category": "Rules Workspace (FEA Code)",
      "description": "1. Create a group '@my_class' in the Groups pane. 2. Use '@my_class' in a GUI Rule (e.g. 'sub @my_class by ...'). 3. Switch to FEA Code tab. 4. Verify the generated code uses `sub @my_class` explicitly, rather than enumerating all members inline.",
      "priority": "high"
    },
    {
        "id": "pos_manager_kerning_editor",
        "category": "Positioning Workspace",
        "description": "In 'Manage Rules' > 'Kerning': 1. Add a new kerning pair manually (Left: A, Right: V, Value: -50). 2. Save. 3. Verify it appears in the list. 4. Verify it appears in the main Kerning Workspace grid with the correct value.",
        "priority": "medium"
    }
]
